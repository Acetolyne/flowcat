# This is a basic workflow to help you get started with Actions

  name: linux-amd64 build/functionality
  # Controls when the workflow will run
  on:
    # Triggers the workflow on push or pull request events but only for the master branch
    push:
      branches: [ 2.x.x ]
    pull_request:
      branches: [ 2.x.x ]
    # Allows you to run this workflow manually from the Actions tab
    workflow_dispatch:
  # A workflow run is made up of one or more jobs that can run sequentially or in parallel
  jobs:
    #Job1
    build:
    # The type of runner that the job will run on
      runs-on: ubuntu-latest

    # Steps represent a sequence of tasks that will be executed as part of the job
      steps:
      # Checks-out your repository under $GITHUB_WORKSPACE, so your job can access it
        - uses: actions/checkout@v2
        - uses: actions/setup-go@v2.1.4
          #with:
            # The Go version to download (if necessary) and use. Supports semver spec and ranges.
            #go-version: # optional
            # Whether to download only stable versions
            #stable: # optional, default is true
            # Used to pull node distributions from go-versions.  Since there's a default, this is typically not supplied by the user.
            #token: # optional, default is ${{ github.token }}

      # Runs a single command using the runners shell
        #- name: Run a one-line script
        #  run: echo Hello, world!

      # Runs a set of commands using the runners shell
        - name: build-script
          run: |
            cd ${{ github.workspace }}
            go get gopkg.in/yaml.v2
            git branch
            ls bin/flowcat-linux-amd64/
            cd tests
            ./test.sh linux-amd64
            if [[ `echo $?` -ne 0 ]]; then exit 1; fi
